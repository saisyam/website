<!doctype html>

<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Saisyam&#39;s personal blog for technical articles" />
  <meta name="author" content="Saisyam" />
  <meta property="og:title" content="Unlock Quality Insights with Great Expectations Python Library" />
<meta property="og:description" content="Poor data quality can be a major issue for businesses, resulting in costly errors and incorrect decisions being made. To avoid these problems, it is important to take steps to ensure the quality of data being used." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://saisyam.com/unlock-quality-insights-with-great-expectations-python-library/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-31T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-12-31T00:00:00+00:00" />

 
  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Unlock Quality Insights with Great Expectations Python Library"/>
<meta name="twitter:description" content="Poor data quality can be a major issue for businesses, resulting in costly errors and incorrect decisions being made. To avoid these problems, it is important to take steps to ensure the quality of data being used."/>

  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-50423294-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  <link rel="stylesheet" href="https://saisyam.com/css/app.min.css" />
  <style>
    #toc::before {
        content: "Table of Contents";
        font-weight: bold;
    }
    #toc nav {
      border-bottom: none;
      padding-bottom: 0.2em;
      font-family: "Ruda", sans-serif;
    }

    ol li, ul li {
      margin-bottom: 0em;
    }

    #toc nav ul {
       
      padding: 1em;
      list-style: decimal;
      display: inline-block;
    }
    ul.pagination {
      display: flex;
      justify-content: center;
      margin: 1em 0 0;
      padding: 0.5em 0;
      list-style: none;
    }
  
    ul.pagination li {
      padding: 0 1em;
    }
    .gist .blob-code-inner{ font-size:13px !important; }
    .gist .blob-num{ font-size:13px !important; }

    .highlight pre code{
      color: #fff;
      text-shadow: none;
    }
  </style>
  <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
  <link rel="manifest" href="favicon/site.webmanifest">
  <link rel="mask-icon" href="favicon/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
</head>


    <body class="post-template">
 
    <header class="header">
  <div class="header-top">
    <a href="https://saisyam.com">
      <h1 class="header-top__title">
        <img class="lazyload header-top__logo initial loaded" src="https://saisyam.com/saisyam.png" data-src="saisyam.png"
          alt="Saisyam's Personal Website" data-was-processed="true">
      </h1>
    </a>
  </div>

  <div class="header-main">
    <div class="container wrapper">
      <div class="grid">
        <label for="menu--toggle" class="header-main__menu--toggle col-xs left">
          <i class="icon icon-menu icon--large">
            <svg class="icon__svg">
              <use xlink:href="#icon-menu">
                <symbol id="icon-menu" viewBox="0 0 24 24">
                  <line x1="3" y1="12" x2="21" y2="12"></line>
                  <line x1="3" y1="6" x2="21" y2="6"></line>
                  <line x1="3" y1="18" x2="21" y2="18"></line>
                </symbol>
              </use>
            </svg>
          </i>
        </label>
        <input type="checkbox" id="menu--toggle" title="Menu" class="is-hidden">

        <nav class="header-main__menu nav col-sm top">
          <ul>
            <li>
              <a href="https://saisyam.com">Home</a>
            </li>
            <li>
              <a href="https://github.com/saisyam" target="_blank">Github</a>
            </li>
            <li>
              <a href="https://linkedin.com/in/saisyam" target="_blank">LinkedIn</a>
            </li>
            <li>
              <a href="https://medium.com/@saisyam" target="_blank">Medium</a>
            </li>
          </ul>

        </nav>
      </div>
    </div>
  </div>
</header>
    <main class="main">
        
<div class="post">
  <div class="container wrapper">
    <div class="post-header">
      <h1 class="post-header__title">Unlock Quality Insights with Great Expectations Python Library</h1>
      <div class="post-header__info">
        <div class="post-header__author">
          <a href="#">Saisyam</a>
        </div>
        <time class="post-header__date" datetime=" 2022-12-31">2022-12-31</time>
        <div class="post-header__read-time">7 min read</div>
      </div>
    </div>
  </div>
  <div id="content" class="container wrapper">
    <div class="grid">
      <article class="col-xs-12 col-md-8">
        <div class="post-content">
          
          <div class="post-content__inner">
            <p>Poor data quality can be a major issue for businesses, resulting in costly errors and incorrect decisions being made. To avoid these problems, it is important to take steps to ensure the quality of data being used. One way to do this is to implement a data quality solution such as <a href="https://greatexpectations.io/">Great Expectations</a>.</p>
<p>With this tool, users can quickly and easily identify data quality issues and ensure that their data is of the highest quality. Additionally, Great Expectations has a built-in testing framework that allows users to quickly write and execute tests on their data. This makes it easier to maintain data quality over time and ensure that data is always up to date and correct. By implementing a data quality solution like Great Expectations, businesses can ensure that their data is of the highest quality and that costly errors and incorrect decisions are avoided.</p>
<p>In this article we will discuss how to setup Great Expectations and apply expectations or rules on a sample dataset. Data engineers can use Great Expectations in different ways. In this post we will discuss code based approach instead of command line approach.</p>
<h2 id="what-is-great-expectations">What is Great Expectations?</h2>
<p>The definition from Great Expectations website:</p>
<blockquote>
<p>Great Expectations is a Python-based open-source library for validating, documenting, and profiling your data. It helps you to maintain data quality and improve communication about data between teams.</p>
</blockquote>
<p>Great Expectations is like unittests for your data. With Great Expectations you can assert what you expect from the data you load and transform. The main features of Great Expectations for Data engineers are:</p>
<ol>
<li>Assert data from other teams or vendors and ensure its validity</li>
<li>Easily integrates into your pipelines in Databricks and Apache Spark</li>
<li>Supports different dataset types - Pandas Dataframe, Spark Dataframe and Databases with SQLAlchemy</li>
<li>Generates metrics and documentation for the results</li>
<li>Provides support to create custom expectations and custom actions to move invalid data to other locations</li>
<li>Integrates seamlessly with DAG execution tools like <a href="https://airflow.apache.org">Airflow</a>, <a href="https://www.getdbt.com">dbt</a>, <a href="https://prefect.io">Prefect</a>, <a href="https://github.com/dagster-io/dagster">Dagster</a>, <a href="https://github.com/quantumblacklabs/kedro">Kendro</a> etc.</li>
</ol>
<h2 id="getting-started">Getting started</h2>
<p>The key feature of Great Expectaions is the <a href="https://docs.greatexpectations.io/docs/#expectations">Expectations</a>. Expectations are assertions about your data. In Great Expectations, expectations are nothing by Python methods. For example, in order to assert that you want the column &ldquo;id&rdquo; to be unique, you can say:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>expect_column_value_to_be_unique(
</span></span><span style="display:flex;"><span>    column<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;id&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>Great Expectations provides such kind of expectations out-of-the-box. If you don&rsquo;t find the expectation you want, you can always write your own expectation. Writing <a href="https://docs.greatexpectations.io/docs/guides/expectations/creating_custom_expectations/overview">custom expectations</a> needs a separate post and hence not in the scope of this article.</p>
<h2 id="how-great-expectations-work">How Great Expectations work</h2>
<p>Let&rsquo;s discuss at a high level how this framework works. Once you install the Great expectations pip package you need to setup the following:</p>
<ul>
<li><strong>Data context</strong> - Data context defines all the configurations required for Great Expectations to work. The two important things you define in data context are data sources and stores.
<ol>
<li>Great Expectations stores your expectations, checkpoints and results in a store. The store can be your file system, an AWS S3 bucket, an Azure blob or Google cloud storage. In this article we will use file system as backendstore.</li>
<li>You have to define which data source you want to apply your expectations. Great Expectations support Pandas dataframe, Spark dataframe and database tables with SQLAlchemy support. In this article we will use Pandas dataframe.</li>
</ol>
</li>
<li><strong>Expectations suite</strong> - An expectation suite contains a set of expectations you want to run on a dataset. You give an expectations suite a valid name so that you can identify what expectations are added to this suite.</li>
<li><strong>Expectation</strong> - Expectation is an assertion or rule that you want to apply on a specific column in your dataset. For example, checking whether the value in the column is in the set of values provided.</li>
<li><strong>Checkpoints</strong> - A checkpoint is a feature in the Great Expectations library that allows you to save the state of your data validation so that you can quickly resume at that point in the future. A checkpoint also allows you to compare data validation results over time. You can define custom checkpoints with custom actions (like storing the failed records in an S3 bucket).</li>
<li><strong>Data docs</strong> - The Great Expectations Python library provides a variety of data docs to help users understand their data and the data expectations they have set. These data docs include:
<ol>
<li>Data Documentation: This provides an overview of the data, including information about the data sources, data types, data quality, and more.</li>
<li>Data Profiling: This provides an in-depth view of the data, including information about the distribution, outliers, missing values, and more.</li>
<li>Data Expectations Reports: This provides an overview of the data expectations that have been set, the results of tests against the expectations, and any issues that have been identified.</li>
<li>Data Validation Reports: This provides a detailed view into the data validation results, including information about any failed tests and any data issues that have been identified.
I prefer to store validation results (a JSON object) into a database for further analysis. The complete source code for this article is available in <a href="https://github.com/saisyam/great-expectations-sample">GitHub</a>.</li>
</ol>
</li>
</ul>
<h2 id="installing-great-expectations">Installing Great Expectations</h2>
<p>I always prefer to setup a virtual environment for my Python projects. I assume you also do the same. Inside your virutal environment, you can install Great Expectations with pip:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ pip install great_expectations
</span></span></code></pre></div><p>Use Python 3.8 and above. Detailed installation steps can be found <a href="https://docs.greatexpectations.io/docs/guides/setup/installation/local">here</a>.</p>
<h2 id="setting-up-the-data-context">Setting up the Data context</h2>
<p>A typical data context config for filesystem looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>STORE_FOLDER <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/Users/saisyam/work/github/great-expectations-sample/ge_data&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Setup data config</span>
</span></span><span style="display:flex;"><span>data_context_config <span style="color:#f92672">=</span> DataContextConfig(
</span></span><span style="display:flex;"><span>    config_version <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>    plugins_directory <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>,
</span></span><span style="display:flex;"><span>    config_variables_file_path <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>,
</span></span><span style="display:flex;"><span>    datasources <span style="color:#f92672">=</span> {},
</span></span><span style="display:flex;"><span>    stores <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;expectations_store&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;ExpectationsStore&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;store_backend&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;TupleFilesystemStoreBackend&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;base_directory&#34;</span>: STORE_FOLDER<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/expectations&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;validations_store&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;ValidationsStore&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;store_backend&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;TupleFilesystemStoreBackend&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;base_directory&#34;</span>: STORE_FOLDER<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/validations&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;checkpoint_store&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;CheckpointStore&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;store_backend&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;TupleFilesystemStoreBackend&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;base_directory&#34;</span>: STORE_FOLDER<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/checkpoints&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;evaluation_parameter_store&#34;</span>: {<span style="color:#e6db74">&#34;class_name&#34;</span>:<span style="color:#e6db74">&#34;EvaluationParameterStore&#34;</span>}
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    expectations_store_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;expectations_store&#34;</span>,
</span></span><span style="display:flex;"><span>    validations_store_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;validations_store&#34;</span>,
</span></span><span style="display:flex;"><span>    evaluation_parameter_store_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;evaluation_parameter_store&#34;</span>,
</span></span><span style="display:flex;"><span>    checkpoint_store_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;checkpoint_store&#34;</span>,
</span></span><span style="display:flex;"><span>    data_docs_sites<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;local_site&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;SiteBuilder&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;store_backend&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;TupleFilesystemStoreBackend&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;base_directory&#34;</span>: STORE_FOLDER<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/data_docs&#34;</span>,
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;site_index_builder&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;DefaultSiteIndexBuilder&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;show_cta_footer&#34;</span>: <span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    anonymous_usage_statistics<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;enabled&#34;</span>: <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>Once we have the config ready, we can set the context with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>context <span style="color:#f92672">=</span> BaseDataContext(project_config <span style="color:#f92672">=</span> data_context_config)
</span></span></code></pre></div><h2 id="setting-up-data-source">Setting up data source</h2>
<p>We will setup a Pandas data source and add it to the context</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>datasource_config <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;sales_datasource&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;Datasource&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;module_name&#34;</span>: <span style="color:#e6db74">&#34;great_expectations.datasource&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;execution_engine&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;module_name&#34;</span>: <span style="color:#e6db74">&#34;great_expectations.execution_engine&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;PandasExecutionEngine&#34;</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;data_connectors&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;default_runtime_data_connector_name&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;class_name&#34;</span>: <span style="color:#e6db74">&#34;RuntimeDataConnector&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;module_name&#34;</span>: <span style="color:#e6db74">&#34;great_expectations.datasource.data_connector&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;batch_identifiers&#34;</span>: [<span style="color:#e6db74">&#34;default_identifier_name&#34;</span>],
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>context<span style="color:#f92672">.</span>add_datasource(<span style="color:#f92672">**</span>datasource_config)
</span></span></code></pre></div><h2 id="creating-expectation-suite-and-add-expectations-to-it">Creating Expectation suite and add Expectations to it</h2>
<p>Now it&rsquo;s time to create an Expectation suite and add expectations to the suite:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Create expectations suite and add expectations</span>
</span></span><span style="display:flex;"><span>suite <span style="color:#f92672">=</span> context<span style="color:#f92672">.</span>create_expectation_suite(expectation_suite_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sales_suite&#34;</span>, overwrite_existing<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Add expectations</span>
</span></span><span style="display:flex;"><span>expectation_config_1 <span style="color:#f92672">=</span> ExpectationConfiguration(
</span></span><span style="display:flex;"><span>    expectation_type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;expect_column_values_to_be_in_set&#34;</span>,
</span></span><span style="display:flex;"><span>    kwargs<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;column&#34;</span>: <span style="color:#e6db74">&#34;product_group&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;value_set&#34;</span>: [<span style="color:#e6db74">&#34;PG1&#34;</span>, <span style="color:#e6db74">&#34;PG2&#34;</span>, <span style="color:#e6db74">&#34;PG3&#34;</span>, <span style="color:#e6db74">&#34;PG4&#34;</span>, <span style="color:#e6db74">&#34;PG5&#34;</span>]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>) 
</span></span><span style="display:flex;"><span>suite<span style="color:#f92672">.</span>add_expectation(expectation_configuration<span style="color:#f92672">=</span>expectation_config_1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>expectation_config_2 <span style="color:#f92672">=</span> ExpectationConfiguration(
</span></span><span style="display:flex;"><span>    expectation_type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;expect_column_values_to_be_unique&#34;</span>,
</span></span><span style="display:flex;"><span>    kwargs<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;column&#34;</span>: <span style="color:#e6db74">&#34;id&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>) 
</span></span><span style="display:flex;"><span>suite<span style="color:#f92672">.</span>add_expectation(expectation_configuration<span style="color:#f92672">=</span>expectation_config_2)
</span></span><span style="display:flex;"><span>context<span style="color:#f92672">.</span>save_expectation_suite(suite, <span style="color:#e6db74">&#34;sales_suite&#34;</span>)
</span></span></code></pre></div><p>Now we have everything ready to run the expectations on dataset.</p>
<h2 id="create-dataset-and-run-checkpoint">Create dataset and run checkpoint</h2>
<p>We will use a <a href="https://github.com/saisyam/great-expectations-sample/blob/master/sales.csv">sample sales dataset</a>. Create a batch request and run the checkpoint. We will use all the default parameters from Great Expectations.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># load and validate data</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;./sales.csv&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>batch_request <span style="color:#f92672">=</span> RuntimeBatchRequest(
</span></span><span style="display:flex;"><span>    datasource_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sales_datasource&#34;</span>,
</span></span><span style="display:flex;"><span>    data_connector_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;default_runtime_data_connector_name&#34;</span>,
</span></span><span style="display:flex;"><span>    data_asset_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;product_sales&#34;</span>,
</span></span><span style="display:flex;"><span>    runtime_parameters<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;batch_data&#34;</span>:df},
</span></span><span style="display:flex;"><span>    batch_identifiers<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;default_identifier_name&#34;</span>:<span style="color:#e6db74">&#34;default_identifier&#34;</span>}
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>checkpoint_config <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;product_sales_checkpoint&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;config_version&#34;</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;class_name&#34;</span>:<span style="color:#e6db74">&#34;SimpleCheckpoint&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;expectation_suite_name&#34;</span>: <span style="color:#e6db74">&#34;sales_suite&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>context<span style="color:#f92672">.</span>add_checkpoint(<span style="color:#f92672">**</span>checkpoint_config)
</span></span><span style="display:flex;"><span>results <span style="color:#f92672">=</span> context<span style="color:#f92672">.</span>run_checkpoint(
</span></span><span style="display:flex;"><span>    checkpoint_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;product_sales_checkpoint&#34;</span>,
</span></span><span style="display:flex;"><span>    validations<span style="color:#f92672">=</span>[
</span></span><span style="display:flex;"><span>        {<span style="color:#e6db74">&#34;batch_request&#34;</span>: batch_request}
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>print(results)
</span></span></code></pre></div><p>The above code will print the validation results as a Python dict. As we have enabled data docs in our config, you will see a <code>data_docs</code> folder under <code>STORE_FOLDER</code> where the HTML output is stored. Each run will create a new HTML file under <code>validations</code> folder inside <code>data_docs</code>. The sample HTML file will look like:
<img src="https://saisyam.com/great_expectations_html_output.jpg" alt="Great Expectation validation results" title="Great Expectation validation results"></p>
<h2 id="conclusion">Conclusion</h2>
<p>We have learnt how to setup and run Great Expectations on a dataset. Great Expectations provides an excellent documentation on how to use different stores (AWS S3, Azure Blob and Google storage) to store expectations and results. The sample code is available in GitHub and you can extend it with different stores. Thanks for reading.</p>

          </div>
        </div>
      </article>
      <aside class="col-xs-12 col-md-4">

        <div class="sidebar">

          <div class="sidebar__section">  
            <h5 class="sidebar__title">Sponsors</h5>
            <script async
              src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0206245742790279"
              crossorigin="anonymous"></script>
            
            <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-0206245742790279"
              data-ad-slot="3209664571" data-ad-format="auto" data-full-width-responsive="true"></ins>
            <script>
              (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
          </div>
        </div>
      </aside>
    </div>
  </div>
</div>
<script type="application/ld+json">
    
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "headline": "Unlock Quality Insights with Great Expectations Python Library",
      "image": "https://saisyam.com/",
      "datePublished": "2022-12-31T00:00:00Z",
      "dateModified": "2022-12-31T00:00:00Z",
      "author": {
        "@type": "Person",
        "name":  null 
      },
      "mainEntityOfPage": { "@type": "WebPage" },
       "publisher": {
        "@type": "Organization",
        "name":  null ,
        "logo": {
          "@type": "ImageObject",
          "url":  null 
        }
      },
      "description": "Poor data quality can be a major issue for businesses, resulting in costly errors and incorrect decisions being made. To avoid these problems, it is important to take steps to ensure the quality of data being used.",
      "keywords": ["Data Quality", "Great Expectations", "Opensource"]
    }
    
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Personal blog",
      "url": "https://saisyam.com/",
      "sameAs": [
        "https://www.facebook.com/saisyam.dampuri.5667",
        "https://www.instagram.com/saisyamdampuri",
        "https://twitter.com/saisyam1",
        "https://github.com/saisyam"
      ]
    }
    </script>

    </main>
    <footer class="footer">
  <div class="container wrapper">
    <div class="footer__bottom">
      <div class="grid">
        <div class="col-lg center-lg">
          <li>© Saisyam - 2021</li>
        </div>
      </div>
    </div>
  </div>
</footer>




<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-50423294-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


</body>
</html>